# Приложение для распознавания речи с использованием Vosk

Это веб-приложение использует библиотеку Vosk для распознавания речи в аудиофайлах. Приложение принимает аудиофайл (например, MP3), преобразует его в формат WAV, выполняет распознавание речи и возвращает результаты в формате JSON, включая информацию о диалоге, источнике речи (приемник/передатчик), полу и интонации (повышенный голос).

## Установка

1. Клонируйте репозиторий на свой локальный компьютер:

    ```bash
    git clone https://github.com/your-username/your-repository.git
    ```

2. Перейдите в директорию проекта:

    ```bash
    cd your-repository
    ```

3. Установите необходимые зависимости:

    ```bash
    pip install -r requirements.txt
    ```

4. Убедитесь, что у вас установлен Vosk-модель для распознавания речи, например, модель для русского языка:

    ```bash
    wget https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip
    unzip vosk-model-small-ru-0.22.zip
    ```

    Убедитесь, что путь к модели указан правильно в файле `app.py`:

    ```python
    vosk_model = Model('/path/to/vosk-model-small-ru-0.22')
    ```

## Запуск

Для запуска приложения используйте команду:

```bash
python app.py
```
По умолчанию сервер будет доступен по адресу http://localhost:5000.

## Использование API

Приложение предоставляет один endpoint: /asr. Этот endpoint принимает POST-запрос с аудиофайлом и возвращает результаты распознавания речи.

Пример с использованием Postman или другого HTTP-клиента:
1. Выберите метод POST.

2. Введите URL: http://localhost:5000/asr.

3. На вкладке Body выберите form-data.

4. Добавьте поле с именем file и выберите файл (MP3 или WAV).

Пример с использованием cURL
```
curl -X POST -F "file=@path_to_your_audio_file.mp3" http://localhost:5000/asr
```

Пример ответа 

```
{
    "dialog": [
        {
            "source": "receiver",
            "text": "Здравствуйте",
            "duration": 5,
            "raised_voice": false,
            "gender": "male"
        },
        {
            "source": "transmitter",
            "text": "Как дела?",
            "duration": 5,
            "raised_voice": false,
            "gender": "female"
        }
    ],
    "result_duration": {
        "receiver": 10,
        "transmitter": 5
    }
}
```
## Структура проекта

1. app.py: основной файл с кодом Flask-приложения.
2. vosk-model-small-ru-0.22/: директория с моделью Vosk для русского языка.
3. requirements.txt: файл с зависимостями Python.
4. uploads/: директория для временного хранения загруженных файлов.

## Примечания

1. Приложение использует библиотеку Vosk для распознавания речи, а также библиотеку Pydub для конвертации MP3 файлов в формат WAV.
2. После обработки аудиофайла временные файлы (MP3 и WAV) удаляются для экономии места на сервере.
3. Модель Vosk используется для распознавания речи и выделения текста на основе аудиофайла.
4. Приложение автоматически определяет, кто говорит в диалоге (приемник или передатчик), а также анализирует повышение интонации (повышенный голос).
